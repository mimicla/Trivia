<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Trivia</title>
    <link rel="stylesheet" href="themes/MyBlueWhite.min.css" />
    <link rel="stylesheet" href="res/styles/jquery.mobile.structure-1.3.2.min.css" />
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.css" />
    <script src="res/js/jquery-1.9.1.min.js"></script>
    <script src="res/js/jquery.mobile-1.3.2.min.js"></script>
    <script src="res/js/cordova.js"></script>
</head>
<body>
<!-- Start of first page -->
<div data-role="page" id="home">
    <div data-role="content">
        <img src="res/Trivia-Logo.png">
        <div data-role="controlgroup">
            <a href="#question?num=random" data-role="button">Play</a>
            <a href="#" data-role="button">Settings</a>
            <a href="#about" data-role="button">About</a>
        </div>
    </div>
</div>

<div data-role="page" id="about" data-add-back-btn="true">
    <div data-role="header">
        <h1>About</h1>
        </div>
    <div data-role="content">
        <p>This app was created for the 'Ingenieria de Software' class final project. It is a simple, trivia style, multiple choice quiz game.</p>
        <p>To download this app for other platforms visit <a href="http://build.phonegap.com/apps/646900/share" rel="external">here</a></p>
    </div>
</div>

<div data-role="page" id="question-page">
    <div data-role="header">
        <a href="#home" data-role="button" data-mini="true">Quit</a>
        <h1>Q#132</h1>
    </div>
    <div data-role="content">
        <div id="question">
            <h3>Question: What is this thing I have to ask as a place holder so it looks like a real trivia question?</h3>
        </div>
        <div data-role="controlgroup" id="choices">
            <a href="#" data-role="button">Option 1</a>
            <a href="#" data-role="button">Option 2</a>
            <a href="#" data-role="button">Option 3</a>
            <a href="#" data-role="button">Option 4</a>
        </div>
    </div>
</div>

</body>
</html>
<script>
    $(document).bind( "pagebeforechange", function( e, data ) {
        // only handle changePage() when loading a page by URL.
        if ( typeof data.toPage === "string" ) {
            // Handle URLs that request chapter page
            var url = $.mobile.path.parseUrl( data.toPage );
            var regex = /^#question/;
            if ( url.hash.search(regex) !== -1 ) {
                showQuestion( url, data.options );
                // tell changePage() we've handled this
                e.preventDefault();
            }
        }
    });


    function showQuestion( urlObj, options )
    {

        var questionNumber = urlObj.hash.replace( /.*num=/, "" );
        $.mobile.showPageLoadingMsg();

        $.getJSON( "questions.json", function( data ) {


            if(questionNumber == 'random'){
                          var ran = Math.floor((Math.random()*data.length)+1);
                questionNumber = ran;
            }

                   var quest;
                   for(q in data){
                       if(data[q].id == questionNumber){
                           quest = data[q];
                           break;
                       }
                   }


                    // Get the page we are going to dump our content into.
                    var $page = $( "#question-page" );

                    // Get the header for the page.
                    var $header = $page.children( ":jqmData(role=header)" );

                    // Get the content area element for the page.
                    var $content = $page.children( ":jqmData(role=content)" );

                    // Find the h1 element in our header and inject the name of
                    // the category into it.
                    $header.find( "h1" )[0].innerHTML = 'Q#'+quest.id;

                    $content.find( "h3" )[0].innerHTML = quest.question;

                    var choices = $content.find( "a" );
                    choices[0].innerHTML = quest.choice1;
                    choices[1].innerHTML = quest.choice2;
                    choices[2].innerHTML = quest.choice3;
                    choices[3].innerHTML = quest.choice4;

            $page.page();
                    options.dataUrl = urlObj.href;
            $.mobile.hidePageLoadingMsg();
                    $.mobile.changePage( $page, options );

                    return;

        });
    }

</script>